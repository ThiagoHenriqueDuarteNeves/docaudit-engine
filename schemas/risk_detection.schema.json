{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://aurora.local/schemas/risk_detection.schema.json",
  "title": "Risk Detection Output",
  "type": "object",
  "additionalProperties": false,
  "required": ["meta", "summary", "items"],
  "properties": {
    "meta": { "$ref": "aurora_adt_output.schema.json#/properties/meta" },
    "summary": { "$ref": "aurora_adt_output.schema.json#/properties/summary" },
    "items": {
      "type": "object",
      "additionalProperties": false,
      "required": ["risks"],
      "properties": {
        "risks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["description", "risk_type", "impact", "evidence", "justification", "mitigation_question"],
            "properties": {
              "description": { "type": "string" },
              "risk_type": { "type": "string", "enum": ["juridico", "administrativo", "operacional"] },
              "impact": { "type": "string", "enum": ["baixo", "medio", "alto"] },
              "evidence": { "type": "string" },
              "justification": { "type": "string" },
              "mitigation_question": { "type": "string" }
            }
          }
        }
      }
    }
  }
}
